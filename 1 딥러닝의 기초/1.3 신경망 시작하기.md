## 3 신경망 시작하기

----

### 신경망의 구조

* 층 : 딥러닝의 구성 단위
	* 텐서를 입력으로 받아 텐서를 출력하는 데이터 처리 모듈
	* 가중치(: 층의 상태, 확률적 경사 하강법에 의해 학습되는 텐서, 네트워크가 학습한 지식 담김) 가짐
	* 층 호환성 layer compatibility : 각 층이 특정 크기의 입력 텐서만 받고 특정 크기의 출력 텐서 반환

* 모델 : 층의 네트워크
	* 딥러닝 모델 : 층으로 만든 비순환 유향 그래프 Directed Acyclic Graph (DAG)
	* 네트워크 구조 => 가설 공간 hypothesis space 정의 (==가능성 있는 공간)

* 손실 함수 & 옵티마이저 : 학습 과정 조절
	* 손실 함수 loss function / 목적 함수 objective function: 훈련하는 동안 최소화될 값, 주어진 문제에 대한 성공 지표
	* 옵티마이저 optimizer : 손실 함수 기반 네트워크 업데이트 결정, 확률적 경사 하강법 구현

----

### 케라스

* 케라스 : 모든 종류의 딥러닝 모델을 간편하게 만들고 훈련시킬 수 있는 파이썬 딥러닝 프레임워크
	* CPU & GPU 실행
	* 쉬운 API
	* 합성곱 신경망, 순환 신경망 지원
	* 모든 네트워크 구조 생성 가능

* 개발 순서
	* 1 입력 텐서 & 타깃 텐서로 이루어진 훈련 데이터 정의
	* 2 모델 정의 : 입력과 타깃을 매핑하는 층으로 이루어진 네트워크 정의
		* 1) Sequential 클래스 사용
			model = model.Sequential()
		* 2) 함수형 API 사용
			model = models.Model(input=input_tensor, outpts=output_tensor)
	* 3 컴파일 단계 : 손실 함수, 옵티마이저, 모니터링하기 위한 지표를 선택하여 학습 과정 설정
		* model.compile(optimizer=optimizer.RMSprop(lr=0.001), loss='mse', metrics=['accuracy'])
	* 4 학습 과정 : 훈련 데이터에 대해 fit() 메서드를 반복 호출
		model.fit(input_tensor, target_tensor, batch_size=128, epochs=10)

----

### 이진 분류 예제 : 영화 리뷰 분류
2종 분류 two-class classification / 이진 분류 binary classification
리뷰 텍스트 기반 영화 리뷰를 긍정, 부정으로 분류하는 방법

* IMDB 데이터셋
- 인터넷 영화 데이터베이스로부터 가져온 양극단의 리뷰 6만 개로 이루어진 IMDB 데이터셋 사용
- 25000개 훈련 데이터, 25000개 테스트 데이터(새로운 데이터에 대한 모델의 성능 측정)
- 50% 긍정, 50% 부정
- 전처리 되어 있어 각 리뷰가 숫자 시퀀스(사전의 고유 단어)로 변환되어 있음

#### IMDB 데이터셋 로드하기
(train_data, train_label), (test_data, train_label) = imdb.load_data(num_words=10000)
// data에는 리뷰 목록 저장, label에는 부정 0 긍정 1 저장

* 데이터 준비
- 같은 길이가 되도록 리스트에 패딩 padding 추가
- 리스트를 원-핫 인코딩 one-hot encoding하여 0과 1의 벡터로 변환

#### 정수 시퀀스를 이진 행렬로 인코딩
def vectorize_sequences(sequences, dimension=10000):
	results = np.zeros((len(sequences), dimension))
	for i, sequence in enumerate(sequences):
		results[i, sequence] = 1.
	return results

x_train = vectorize_sequences(train_data)
x_test = vectorize_sequences(test_data)